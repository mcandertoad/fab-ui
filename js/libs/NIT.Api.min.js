
if(!Object.keys){Object.keys=(function(){'use strict';var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!({toString:null}).propertyIsEnumerable('toString'),dontEnums=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'],dontEnumsLength=dontEnums.length;return function(obj){if(typeof obj!=='object'&&(typeof obj!=='function'||obj===null)){throw new TypeError('Object.keys called on non-object');}
var result=[],prop,i;for(prop in obj){if(hasOwnProperty.call(obj,prop)){result.push(prop);}}
if(hasDontEnumBug){for(i=0;i<dontEnumsLength;i++){if(hasOwnProperty.call(obj,dontEnums[i])){result.push(dontEnums[i]);}}}
return result;};}());}
if(!Array.prototype.indexOf){Array.prototype.indexOf=function(searchElement,fromIndex){var k;if(this==null){throw new TypeError('"this" is null or not defined');}
var O=Object(this);var len=O.length>>>0;if(len===0){return-1;}
var n=+fromIndex||0;if(Math.abs(n)===Infinity){n=0;}
if(n>=len){return-1;}
k=Math.max(n>=0?n:len-Math.abs(n),0);while(k<len){if(k in O&&O[k]===searchElement){return k;}
k++;}
return-1;};}
if(!Array.prototype.filter){Array.prototype.filter=function(fun){'use strict';if(this===void 0||this===null){throw new TypeError();}
var t=Object(this);var len=t.length>>>0;if(typeof fun!=='function'){throw new TypeError();}
var res=[];var thisArg=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<len;i++){if(i in t){var val=t[i];if(fun.call(thisArg,val,i,t)){res.push(val);}}}
return res;};}
if(!String.prototype.format){String.prototype.format=function(){var args=arguments;return this.replace(/\{(\d+)}/g,function(match,number){return typeof args[number]!=='undefined'?args[number]:match;});};}
if(!String.prototype.trimStart){String.prototype.trimStart=function(){return this.replace(/^\s+/,'');};}
if(!String.prototype.trimEnd){String.prototype.trimEnd=function(){return this.replace(/\s+$/,'');};}
if(!String.prototype.isEmptyOrWhitespace){String.prototype.isEmptyOrWhitespace=function(){return/^\s*$/.test(this);};}
if(!String.prototype.beginsWith){String.prototype.beginsWith=function(prefix){return this.slice(0,prefix.length)===prefix;};}
if(!String.prototype.endsWith){String.prototype.endsWith=function(suffix){return this.slice(-suffix.length)===suffix;};}
if(!String.prototype.parseXml){String.prototype.parseXml=(function(){if(typeof window.DOMParser!=="undefined"){return function(){return(new window.DOMParser()).parseFromString(this,"text/xml");};}else if(typeof window.ActiveXObject!=="undefined"&&new window.ActiveXObject("Microsoft.XMLDOM")){return function(){var xmlDoc=new window.ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";xmlDoc.loadXML(this);return xmlDoc;};}else{throw new Error("No XML parser found");}})();}
if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,'');};}
(function(){"use strict";function lib$es6$promise$utils$$objectOrFunction(x){return typeof x==='function'||(typeof x==='object'&&x!==null);}
function lib$es6$promise$utils$$isFunction(x){return typeof x==='function';}
function lib$es6$promise$utils$$isMaybeThenable(x){return typeof x==='object'&&x!==null;}
var lib$es6$promise$utils$$_isArray;if(!Array.isArray){lib$es6$promise$utils$$_isArray=function(x){return Object.prototype.toString.call(x)==='[object Array]';};}else{lib$es6$promise$utils$$_isArray=Array.isArray;}
var lib$es6$promise$utils$$isArray=lib$es6$promise$utils$$_isArray;var lib$es6$promise$asap$$len=0;var lib$es6$promise$asap$$toString={}.toString;var lib$es6$promise$asap$$vertxNext;var lib$es6$promise$asap$$customSchedulerFn;var lib$es6$promise$asap$$asap=function asap(callback,arg){lib$es6$promise$asap$$queue[lib$es6$promise$asap$$len]=callback;lib$es6$promise$asap$$queue[lib$es6$promise$asap$$len+1]=arg;lib$es6$promise$asap$$len+=2;if(lib$es6$promise$asap$$len===2){if(lib$es6$promise$asap$$customSchedulerFn){lib$es6$promise$asap$$customSchedulerFn(lib$es6$promise$asap$$flush);}else{lib$es6$promise$asap$$scheduleFlush();}}}
function lib$es6$promise$asap$$setScheduler(scheduleFn){lib$es6$promise$asap$$customSchedulerFn=scheduleFn;}
function lib$es6$promise$asap$$setAsap(asapFn){lib$es6$promise$asap$$asap=asapFn;}
var lib$es6$promise$asap$$browserWindow=(typeof window!=='undefined')?window:undefined;var lib$es6$promise$asap$$browserGlobal=lib$es6$promise$asap$$browserWindow||{};var lib$es6$promise$asap$$BrowserMutationObserver=lib$es6$promise$asap$$browserGlobal.MutationObserver||lib$es6$promise$asap$$browserGlobal.WebKitMutationObserver;var lib$es6$promise$asap$$isNode=typeof process!=='undefined'&&{}.toString.call(process)==='[object process]';var lib$es6$promise$asap$$isWorker=typeof Uint8ClampedArray!=='undefined'&&typeof importScripts!=='undefined'&&typeof MessageChannel!=='undefined';function lib$es6$promise$asap$$useNextTick(){return function(){process.nextTick(lib$es6$promise$asap$$flush);};}
function lib$es6$promise$asap$$useVertxTimer(){return function(){lib$es6$promise$asap$$vertxNext(lib$es6$promise$asap$$flush);};}
function lib$es6$promise$asap$$useMutationObserver(){var iterations=0;var observer=new lib$es6$promise$asap$$BrowserMutationObserver(lib$es6$promise$asap$$flush);var node=document.createTextNode('');observer.observe(node,{characterData:true});return function(){node.data=(iterations=++iterations%2);};}
function lib$es6$promise$asap$$useMessageChannel(){var channel=new MessageChannel();channel.port1.onmessage=lib$es6$promise$asap$$flush;return function(){channel.port2.postMessage(0);};}
function lib$es6$promise$asap$$useSetTimeout(){return function(){setTimeout(lib$es6$promise$asap$$flush,1);};}
var lib$es6$promise$asap$$queue=new Array(1000);function lib$es6$promise$asap$$flush(){for(var i=0;i<lib$es6$promise$asap$$len;i+=2){var callback=lib$es6$promise$asap$$queue[i];var arg=lib$es6$promise$asap$$queue[i+1];callback(arg);lib$es6$promise$asap$$queue[i]=undefined;lib$es6$promise$asap$$queue[i+1]=undefined;}
lib$es6$promise$asap$$len=0;}
function lib$es6$promise$asap$$attemptVertx(){try{var r=require;var vertx=r('vertx');lib$es6$promise$asap$$vertxNext=vertx.runOnLoop||vertx.runOnContext;return lib$es6$promise$asap$$useVertxTimer();}catch(e){return lib$es6$promise$asap$$useSetTimeout();}}
var lib$es6$promise$asap$$scheduleFlush;if(lib$es6$promise$asap$$isNode){lib$es6$promise$asap$$scheduleFlush=lib$es6$promise$asap$$useNextTick();}else if(lib$es6$promise$asap$$BrowserMutationObserver){lib$es6$promise$asap$$scheduleFlush=lib$es6$promise$asap$$useMutationObserver();}else if(lib$es6$promise$asap$$isWorker){lib$es6$promise$asap$$scheduleFlush=lib$es6$promise$asap$$useMessageChannel();}else if(lib$es6$promise$asap$$browserWindow===undefined&&typeof require==='function'){lib$es6$promise$asap$$scheduleFlush=lib$es6$promise$asap$$attemptVertx();}else{lib$es6$promise$asap$$scheduleFlush=lib$es6$promise$asap$$useSetTimeout();}
function lib$es6$promise$$internal$$noop(){}
var lib$es6$promise$$internal$$PENDING=void 0;var lib$es6$promise$$internal$$FULFILLED=1;var lib$es6$promise$$internal$$REJECTED=2;var lib$es6$promise$$internal$$GET_THEN_ERROR=new lib$es6$promise$$internal$$ErrorObject();function lib$es6$promise$$internal$$selfFulfillment(){return new TypeError("You cannot resolve a promise with itself");}
function lib$es6$promise$$internal$$cannotReturnOwn(){return new TypeError('A promises callback cannot return that same promise.');}
function lib$es6$promise$$internal$$getThen(promise){try{return promise.then;}catch(error){lib$es6$promise$$internal$$GET_THEN_ERROR.error=error;return lib$es6$promise$$internal$$GET_THEN_ERROR;}}
function lib$es6$promise$$internal$$tryThen(then,value,fulfillmentHandler,rejectionHandler){try{then.call(value,fulfillmentHandler,rejectionHandler);}catch(e){return e;}}
function lib$es6$promise$$internal$$handleForeignThenable(promise,thenable,then){lib$es6$promise$asap$$asap(function(promise){var sealed=false;var error=lib$es6$promise$$internal$$tryThen(then,thenable,function(value){if(sealed){return;}
sealed=true;if(thenable!==value){lib$es6$promise$$internal$$resolve(promise,value);}else{lib$es6$promise$$internal$$fulfill(promise,value);}},function(reason){if(sealed){return;}
sealed=true;lib$es6$promise$$internal$$reject(promise,reason);},'Settle: '+(promise._label||' unknown promise'));if(!sealed&&error){sealed=true;lib$es6$promise$$internal$$reject(promise,error);}},promise);}
function lib$es6$promise$$internal$$handleOwnThenable(promise,thenable){if(thenable._state===lib$es6$promise$$internal$$FULFILLED){lib$es6$promise$$internal$$fulfill(promise,thenable._result);}else if(thenable._state===lib$es6$promise$$internal$$REJECTED){lib$es6$promise$$internal$$reject(promise,thenable._result);}else{lib$es6$promise$$internal$$subscribe(thenable,undefined,function(value){lib$es6$promise$$internal$$resolve(promise,value);},function(reason){lib$es6$promise$$internal$$reject(promise,reason);});}}
function lib$es6$promise$$internal$$handleMaybeThenable(promise,maybeThenable){if(maybeThenable.constructor===promise.constructor){lib$es6$promise$$internal$$handleOwnThenable(promise,maybeThenable);}else{var then=lib$es6$promise$$internal$$getThen(maybeThenable);if(then===lib$es6$promise$$internal$$GET_THEN_ERROR){lib$es6$promise$$internal$$reject(promise,lib$es6$promise$$internal$$GET_THEN_ERROR.error);}else if(then===undefined){lib$es6$promise$$internal$$fulfill(promise,maybeThenable);}else if(lib$es6$promise$utils$$isFunction(then)){lib$es6$promise$$internal$$handleForeignThenable(promise,maybeThenable,then);}else{lib$es6$promise$$internal$$fulfill(promise,maybeThenable);}}}
function lib$es6$promise$$internal$$resolve(promise,value){if(promise===value){lib$es6$promise$$internal$$reject(promise,lib$es6$promise$$internal$$selfFulfillment());}else if(lib$es6$promise$utils$$objectOrFunction(value)){lib$es6$promise$$internal$$handleMaybeThenable(promise,value);}else{lib$es6$promise$$internal$$fulfill(promise,value);}}
function lib$es6$promise$$internal$$publishRejection(promise){if(promise._onerror){promise._onerror(promise._result);}
lib$es6$promise$$internal$$publish(promise);}
function lib$es6$promise$$internal$$fulfill(promise,value){if(promise._state!==lib$es6$promise$$internal$$PENDING){return;}
promise._result=value;promise._state=lib$es6$promise$$internal$$FULFILLED;if(promise._subscribers.length!==0){lib$es6$promise$asap$$asap(lib$es6$promise$$internal$$publish,promise);}}
function lib$es6$promise$$internal$$reject(promise,reason){if(promise._state!==lib$es6$promise$$internal$$PENDING){return;}
promise._state=lib$es6$promise$$internal$$REJECTED;promise._result=reason;lib$es6$promise$asap$$asap(lib$es6$promise$$internal$$publishRejection,promise);}
function lib$es6$promise$$internal$$subscribe(parent,child,onFulfillment,onRejection){var subscribers=parent._subscribers;var length=subscribers.length;parent._onerror=null;subscribers[length]=child;subscribers[length+lib$es6$promise$$internal$$FULFILLED]=onFulfillment;subscribers[length+lib$es6$promise$$internal$$REJECTED]=onRejection;if(length===0&&parent._state){lib$es6$promise$asap$$asap(lib$es6$promise$$internal$$publish,parent);}}
function lib$es6$promise$$internal$$publish(promise){var subscribers=promise._subscribers;var settled=promise._state;if(subscribers.length===0){return;}
var child,callback,detail=promise._result;for(var i=0;i<subscribers.length;i+=3){child=subscribers[i];callback=subscribers[i+settled];if(child){lib$es6$promise$$internal$$invokeCallback(settled,child,callback,detail);}else{callback(detail);}}
promise._subscribers.length=0;}
function lib$es6$promise$$internal$$ErrorObject(){this.error=null;}
var lib$es6$promise$$internal$$TRY_CATCH_ERROR=new lib$es6$promise$$internal$$ErrorObject();function lib$es6$promise$$internal$$tryCatch(callback,detail){try{return callback(detail);}catch(e){lib$es6$promise$$internal$$TRY_CATCH_ERROR.error=e;return lib$es6$promise$$internal$$TRY_CATCH_ERROR;}}
function lib$es6$promise$$internal$$invokeCallback(settled,promise,callback,detail){var hasCallback=lib$es6$promise$utils$$isFunction(callback),value,error,succeeded,failed;if(hasCallback){value=lib$es6$promise$$internal$$tryCatch(callback,detail);if(value===lib$es6$promise$$internal$$TRY_CATCH_ERROR){failed=true;error=value.error;value=null;}else{succeeded=true;}
if(promise===value){lib$es6$promise$$internal$$reject(promise,lib$es6$promise$$internal$$cannotReturnOwn());return;}}else{value=detail;succeeded=true;}
if(promise._state!==lib$es6$promise$$internal$$PENDING){}else if(hasCallback&&succeeded){lib$es6$promise$$internal$$resolve(promise,value);}else if(failed){lib$es6$promise$$internal$$reject(promise,error);}else if(settled===lib$es6$promise$$internal$$FULFILLED){lib$es6$promise$$internal$$fulfill(promise,value);}else if(settled===lib$es6$promise$$internal$$REJECTED){lib$es6$promise$$internal$$reject(promise,value);}}
function lib$es6$promise$$internal$$initializePromise(promise,resolver){try{resolver(function resolvePromise(value){lib$es6$promise$$internal$$resolve(promise,value);},function rejectPromise(reason){lib$es6$promise$$internal$$reject(promise,reason);});}catch(e){lib$es6$promise$$internal$$reject(promise,e);}}
function lib$es6$promise$enumerator$$Enumerator(Constructor,input){var enumerator=this;enumerator._instanceConstructor=Constructor;enumerator.promise=new Constructor(lib$es6$promise$$internal$$noop);if(enumerator._validateInput(input)){enumerator._input=input;enumerator.length=input.length;enumerator._remaining=input.length;enumerator._init();if(enumerator.length===0){lib$es6$promise$$internal$$fulfill(enumerator.promise,enumerator._result);}else{enumerator.length=enumerator.length||0;enumerator._enumerate();if(enumerator._remaining===0){lib$es6$promise$$internal$$fulfill(enumerator.promise,enumerator._result);}}}else{lib$es6$promise$$internal$$reject(enumerator.promise,enumerator._validationError());}}
lib$es6$promise$enumerator$$Enumerator.prototype._validateInput=function(input){return lib$es6$promise$utils$$isArray(input);};lib$es6$promise$enumerator$$Enumerator.prototype._validationError=function(){return new Error('Array Methods must be provided an Array');};lib$es6$promise$enumerator$$Enumerator.prototype._init=function(){this._result=new Array(this.length);};var lib$es6$promise$enumerator$$default=lib$es6$promise$enumerator$$Enumerator;lib$es6$promise$enumerator$$Enumerator.prototype._enumerate=function(){var enumerator=this;var length=enumerator.length;var promise=enumerator.promise;var input=enumerator._input;for(var i=0;promise._state===lib$es6$promise$$internal$$PENDING&&i<length;i++){enumerator._eachEntry(input[i],i);}};lib$es6$promise$enumerator$$Enumerator.prototype._eachEntry=function(entry,i){var enumerator=this;var c=enumerator._instanceConstructor;if(lib$es6$promise$utils$$isMaybeThenable(entry)){if(entry.constructor===c&&entry._state!==lib$es6$promise$$internal$$PENDING){entry._onerror=null;enumerator._settledAt(entry._state,i,entry._result);}else{enumerator._willSettleAt(c.resolve(entry),i);}}else{enumerator._remaining--;enumerator._result[i]=entry;}};lib$es6$promise$enumerator$$Enumerator.prototype._settledAt=function(state,i,value){var enumerator=this;var promise=enumerator.promise;if(promise._state===lib$es6$promise$$internal$$PENDING){enumerator._remaining--;if(state===lib$es6$promise$$internal$$REJECTED){lib$es6$promise$$internal$$reject(promise,value);}else{enumerator._result[i]=value;}}
if(enumerator._remaining===0){lib$es6$promise$$internal$$fulfill(promise,enumerator._result);}};lib$es6$promise$enumerator$$Enumerator.prototype._willSettleAt=function(promise,i){var enumerator=this;lib$es6$promise$$internal$$subscribe(promise,undefined,function(value){enumerator._settledAt(lib$es6$promise$$internal$$FULFILLED,i,value);},function(reason){enumerator._settledAt(lib$es6$promise$$internal$$REJECTED,i,reason);});};function lib$es6$promise$promise$all$$all(entries){return new lib$es6$promise$enumerator$$default(this,entries).promise;}
var lib$es6$promise$promise$all$$default=lib$es6$promise$promise$all$$all;function lib$es6$promise$promise$race$$race(entries){var Constructor=this;var promise=new Constructor(lib$es6$promise$$internal$$noop);if(!lib$es6$promise$utils$$isArray(entries)){lib$es6$promise$$internal$$reject(promise,new TypeError('You must pass an array to race.'));return promise;}
var length=entries.length;function onFulfillment(value){lib$es6$promise$$internal$$resolve(promise,value);}
function onRejection(reason){lib$es6$promise$$internal$$reject(promise,reason);}
for(var i=0;promise._state===lib$es6$promise$$internal$$PENDING&&i<length;i++){lib$es6$promise$$internal$$subscribe(Constructor.resolve(entries[i]),undefined,onFulfillment,onRejection);}
return promise;}
var lib$es6$promise$promise$race$$default=lib$es6$promise$promise$race$$race;function lib$es6$promise$promise$resolve$$resolve(object){var Constructor=this;if(object&&typeof object==='object'&&object.constructor===Constructor){return object;}
var promise=new Constructor(lib$es6$promise$$internal$$noop);lib$es6$promise$$internal$$resolve(promise,object);return promise;}
var lib$es6$promise$promise$resolve$$default=lib$es6$promise$promise$resolve$$resolve;function lib$es6$promise$promise$reject$$reject(reason){var Constructor=this;var promise=new Constructor(lib$es6$promise$$internal$$noop);lib$es6$promise$$internal$$reject(promise,reason);return promise;}
var lib$es6$promise$promise$reject$$default=lib$es6$promise$promise$reject$$reject;var lib$es6$promise$promise$$counter=0;function lib$es6$promise$promise$$needsResolver(){throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');}
function lib$es6$promise$promise$$needsNew(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}
var lib$es6$promise$promise$$default=lib$es6$promise$promise$$Promise;function lib$es6$promise$promise$$Promise(resolver){this._id=lib$es6$promise$promise$$counter++;this._state=undefined;this._result=undefined;this._subscribers=[];if(lib$es6$promise$$internal$$noop!==resolver){if(!lib$es6$promise$utils$$isFunction(resolver)){lib$es6$promise$promise$$needsResolver();}
if(!(this instanceof lib$es6$promise$promise$$Promise)){lib$es6$promise$promise$$needsNew();}
lib$es6$promise$$internal$$initializePromise(this,resolver);}}
lib$es6$promise$promise$$Promise.all=lib$es6$promise$promise$all$$default;lib$es6$promise$promise$$Promise.race=lib$es6$promise$promise$race$$default;lib$es6$promise$promise$$Promise.resolve=lib$es6$promise$promise$resolve$$default;lib$es6$promise$promise$$Promise.reject=lib$es6$promise$promise$reject$$default;lib$es6$promise$promise$$Promise._setScheduler=lib$es6$promise$asap$$setScheduler;lib$es6$promise$promise$$Promise._setAsap=lib$es6$promise$asap$$setAsap;lib$es6$promise$promise$$Promise._asap=lib$es6$promise$asap$$asap;lib$es6$promise$promise$$Promise.prototype={constructor:lib$es6$promise$promise$$Promise,then:function(onFulfillment,onRejection){var parent=this;var state=parent._state;if(state===lib$es6$promise$$internal$$FULFILLED&&!onFulfillment||state===lib$es6$promise$$internal$$REJECTED&&!onRejection){return this;}
var child=new this.constructor(lib$es6$promise$$internal$$noop);var result=parent._result;if(state){var callback=arguments[state-1];lib$es6$promise$asap$$asap(function(){lib$es6$promise$$internal$$invokeCallback(state,child,callback,result);});}else{lib$es6$promise$$internal$$subscribe(parent,child,onFulfillment,onRejection);}
return child;},'catch':function(onRejection){return this.then(null,onRejection);}};function lib$es6$promise$polyfill$$polyfill(){var local;if(typeof global!=='undefined'){local=global;}else if(typeof self!=='undefined'){local=self;}else{try{local=Function('return this')();}catch(e){throw new Error('polyfill failed because global object is unavailable in this environment');}}
var P=local.Promise;if(typeof Promise!=="undefined"&&Promise.toString().indexOf("[native code]")!==-1){return;}
local.Promise=lib$es6$promise$promise$$default;}
var lib$es6$promise$polyfill$$default=lib$es6$promise$polyfill$$polyfill;var lib$es6$promise$umd$$ES6Promise={'Promise':lib$es6$promise$promise$$default,'polyfill':lib$es6$promise$polyfill$$default};if(typeof define==='function'&&define['amd']){define('ES6Promise',function(){return lib$es6$promise$umd$$ES6Promise;});}else if(typeof module!=='undefined'&&module['exports']){module['exports']=lib$es6$promise$umd$$ES6Promise;}else if(typeof this!=='undefined'){this['ES6Promise']=lib$es6$promise$umd$$ES6Promise;}
lib$es6$promise$polyfill$$default();}).call(this);(function(global){'use strict';var knownDeps={},resolvedDeps={},registerDependency=function(name,deps,funcOrInstance){if(arguments.length!==3){throw new Error('Only the three-argument version of define() is supported.');}
var factory=(typeof funcOrInstance==='function')?funcOrInstance:function(){return funcOrInstance;};knownDeps[name]={name:name,deps:deps||[],factory:factory};},getDepInfo=function(name){if(typeof knownDeps[name]!=='undefined'){return knownDeps[name];}
throw new Error('"'+name+'" has not been defined');},createInstance=function(depInfo,deps){if(typeof deps[depInfo.name]!=='undefined'){return;}
var params=[];for(var i=0;i<depInfo.deps.length;++i){createInstance(getDepInfo(depInfo.deps[i]),deps);params.push(deps[depInfo.deps[i]]);}
var instance=depInfo.factory.apply(this,params);if(typeof instance==='undefined'||instance===null){throw new Error('Function provided when defining "'+depInfo.name+'" must return a non-null/non-undefined value');}
deps[depInfo.name]=instance;},resolveNamedDependency=function(name){if(typeof knownDeps[name]==='undefined'){throw new Error('"'+name+'" has not been defined');}
var edges=createEdges(name,knownDeps);var sortedDeps=toposort(edges);for(var i=sortedDeps.length-1;i>=0;--i){var depName=sortedDeps[i];createInstance(getDepInfo(depName),resolvedDeps);}
createInstance(getDepInfo(name),resolvedDeps);return resolvedDeps[name];},resolveDependency=function(deps,callback){var i;if(arguments.length<=0||arguments.length>2){throw new Error('Only two require syntaxes are supported: (1)'+' require(<name>), and (2) require([<dep1>, <dep2>, ...], callbackFunction)');}else if(arguments.length===1){if(typeof deps!=='string'){throw new Error('The single-argument version of require expects'+' a string as its parameter, but its type was "'+(typeof deps)+'"');}
return resolveNamedDependency(deps);}else if(!Array.isArray(deps)){throw new Error('The two-argument version of require expects'+' an array as its first parameter, but its type was "'+(typeof deps)+'"');}else if(typeof callback!=='function'){throw new Error('The two-argument version of require expects'+' a function as its second parameter, but its type was "'+(typeof callback)+'"');}
var callbackParams=[];for(i=0;i<deps.length;++i){callbackParams.push(resolveNamedDependency(deps[i]));}
callback.apply(this,callbackParams);},_getState=function(){return{knownDeps:knownDeps,resolvedDeps:resolvedDeps};},_setState=function(state){knownDeps=state.knownDeps;resolvedDeps=state.resolvedDeps;},_reset=function(){var state=_getState();knownDeps={};resolvedDeps={};registerDependency('require',[],function(){return resolveDependency;});return state;},_createNitRequire=function(define,require,getState,setState,reset){define.amd=true;return{define:define,require:require,_getState:getState,_setState:setState,_reset:reset};},_nitrequire=_createNitRequire(registerDependency,resolveDependency,_getState,_setState,_reset);_reset();if(typeof define==='function'&&define.amd){}else{global.nitrequire=_nitrequire;global.define=_nitrequire.define;global.require=_nitrequire.require;};function createEdges(name,deps){var depName,edges=[];var depStack=[name];var visited={};while(depStack.length!=0){var sourceName=depStack.pop();visited[sourceName]=true;for(var j=0;typeof deps[sourceName]!=='undefined'&&j<deps[sourceName].deps.length;++j){depName=deps[sourceName].deps[j];edges.push([sourceName,depName]);if(!visited[depName]){depStack.push(depName);}}}
return edges;}
function toposort(edges){return _toposort(uniqueNodes(edges),edges);}
function _toposort(nodes,edges){var cursor=nodes.length,sorted=new Array(cursor),visited={},i=cursor;while(i--){if(!visited[i]){visit(nodes[i],i,[]);}}
return sorted;function visit(node,i,predecessors){if(predecessors.indexOf(node)>=0){var message=[].concat(predecessors,node).join(' -> ');throw new Error('Found a dependency cycle: '+message);}
if(visited[i])return;visited[i]=true;var outgoing=edges.filter(function(edge){return edge[0]===node;});if(i=outgoing.length){var preds=predecessors.concat(node);do{var child=outgoing[--i][1];visit(child,nodes.indexOf(child),preds);}while(i)}
sorted[--cursor]=node;}}
function uniqueNodes(arr){var res=[];for(var i=0,len=arr.length;i<len;i++){var edge=arr[i];if(res.indexOf(edge[0])<0){res.push(edge[0]);}
if(res.indexOf(edge[1])<0){res.push(edge[1]);}}
return res;}})(typeof window!=='undefined'?window:typeof global!=='undefined'?global:this);define('NIT.Agent.Types',[],function(){'use strict';function Agent(ConverseTypes,converse,session,responseActionProvider,deferredAppcallProvider,utils,logger){var self=this;var events={};this.supportedEvents={ResponseReceived:"onAgentResponse",ErrorReceived:"onAgentError",HistoryLoaded:"onAgentHistoryLoaded",ConversationReverted:"onAgentConversationReverted",SessionEventReported:"onAgentReportingEvent",BeforeInputSent:"onBeforeInputSent",BeforeAppEventSent:"onBeforeAppEventSent",BeforeUnitRequestSent:"onBeforeUnitRequestSent"};this.addEventListener=function(name,handler){if(events.hasOwnProperty(name)){events[name].push(handler);}else{events[name]=[handler];}};this.removeEventListener=function(name,handler){if(!events.hasOwnProperty(name)){return;}
var index=events[name].indexOf(handler);if(index!==-1){events[name].splice(index,1);}};function _fireEvent(name){if(!events.hasOwnProperty(name)){return;}
var args=[];if(arguments.length>1){args=Array.prototype.slice.call(arguments,1);}
var evs=events[name].slice(),l=evs.length;for(var i=0;i<l;i++){try{evs[i].apply(null,args);}catch(e){logger.error("NIT.AGENT: Failure Processing '{0}' event handler - {1}".format(name,e));}}}
this.sendInput=function(input){assertValidConverseArgs(input);var request=parseConverseInput(input);return new Promise(function(resolve,reject){_fireEvent(self.supportedEvents.BeforeInputSent,request);converse.sendConverseRequest(request,createHandlePromiseResponse(resolve,reject),createHandleErrorPromiseResponse(reject));});};function createHandlePromiseResponse(resolve,reject){return function(response){handleResponse(response,resolve,reject);}}
function createHandleErrorPromiseResponse(reject){return function(xhr,statusText,error){handleError(xhr,statusText,error);reject({xhr:xhr,statusText:statusText,error:error});};}
function assertValidConverseArgs(input){if(input===null||typeof input==='undefined'){throw new Error('sendInput: input argument must be defined and non-null');}
if(typeof input==='string'&&input===''){throw new Error('sendInput: input argument must not be the empty string');}
if(typeof input!=='string'){if(typeof input.question==='undefined'){throw new Error('sendInput: input object must contain a question property');}else if(input.question===''){throw new Error('sendInput: input object question property must not be the empty string');}}}
function parseConverseInput(input){var request;if(typeof input==='string'){request=new ConverseTypes.ConverseRequestObject(session.getAgentUserId(),session.getAgentSessionId(),input);}else{request=new ConverseTypes.ConverseRequestObject(session.getAgentUserId(),session.getAgentSessionId());mergeExistingPropertiesInto(request,input,request);}
if(!request.origin){request.origin='Typed';}
return request;}
this.getConversationHistory=function(){assertValidConversationHistoryArgs(arguments);var request=parseConversationHistoryData(arguments);return new Promise(function(resolve,reject){converse.sendGetHistoryRequest(request,function(responses){_fireEvent(self.supportedEvents.HistoryLoaded,responses);resolve(responses);},createHandleErrorPromiseResponse(reject));});};function assertValidConversationHistoryArgs(args){if(args.length>1){throw new Error('getConversationHistory: optionally expected 1 argument, received '
+args.length);}
if(args.length===1&&(typeof args[0]!=='object'||args[0]===null)){throw new TypeError('getConversationHistory: if specified, argument is required to be an object');}}
function parseConversationHistoryData(args){var request=new ConverseTypes.GetHistoryRequestObject(session.getAgentUserId(),session.getAgentSessionId());if(args.length===1){mergeExistingPropertiesInto(request,args[0],request);}
return request;}
this.sendAppEvent=function(name,params){assertValidAppEventArgs(arguments);var request=parseAppEventData(arguments);return new Promise(function(resolve,reject){_fireEvent(self.supportedEvents.BeforeAppEventSent,request);converse.sendAppEvent(request,createHandlePromiseResponse(resolve,reject),createHandleErrorPromiseResponse(reject));});};function assertValidAppEventArgs(args){if(args.length<1||args.length>2){throw new Error('sendAppEvent: expected 1 or 2 arguments, received '
+args.length);}
if(args.length>=1){if((typeof args[0]!=='object'&&typeof args[0]!=='string')||args[0]===null||args[0]===''){throw new Error('sendAppEvent: name must be a non-empty string or object');}else if(typeof args[0]==='object'&&(typeof args[0].eventName!=='string'||args[0].eventName==='')){throw new Error('sendAppEvent: detail must contain an non-empty string '+'eventName property');}}
if(args.length===2){if(typeof args[1]!=='object'||args[1]===null){throw new TypeError('sendAppEvent: params must be of type object.');}}}
function parseAppEventData(args){var detail={userID:session.getAgentUserId(),sessionID:session.getAgentSessionId(),origin:'Internal'};if(args.length===1&&typeof args[0]==='string'){detail.eventName=args[0];}else if(args.length===1&&typeof args[0]==='object'){detail=args[0];detail.userID=detail.userID||session.getAgentUserId();detail.sessionID=detail.sessionID||session.getAgentSessionId();}else{detail.eventName=args[0];detail.parameters=args[1];}
var request=new ConverseTypes.ApplicationEventRequestObject();mergeExistingPropertiesInto(request,detail,request);return request;}
this.getUnit=function(unitId,displayText){assertValidUnitRequestArgs(arguments);var request=parseUnitRequestData(arguments);return new Promise(function(resolve,reject){_fireEvent(self.supportedEvents.BeforeUnitRequestSent,request);converse.sendUnitRequest(request,createHandlePromiseResponse(resolve,reject),createHandleErrorPromiseResponse(reject));});};function assertValidUnitRequestArgs(args){if(args.length<1||args.length>2){throw new Error('getUnit: expected 1 or 2 arguments, received '+args.length);}
if(args.length===1){if(typeof args[0]!=='object'||args[0]===null){throw new TypeError('getUnit: 1-arg version requires argument to be an object');}
if(!args[0].unitId){throw new Error('getUnit: 1-arg version must contain unitId property');}
if(!args[0].displayText){throw new Error('getUnit: 1-arg version must contain displayText property');}}else{if(typeof args[0]!=='string'||args[0]===null||args[0]===''){throw new TypeError('getUnit: 2-arg version requires first argument to be a string.');}
if(typeof args[1]!=='string'||args[1]===null||args[1]===''){throw new TypeError('getUnit: 2-arg version requires second argument to be a string.');}}}
function parseUnitRequestData(args){var detail;if(args.length===1){detail=args[0];detail.userID=detail.userID||session.getAgentUserId();detail.sessionID=detail.sessionID||session.getAgentSessionId();detail.origin=detail.origin||'Click';}else{detail={userID:session.getAgentUserId(),sessionID:session.getAgentSessionId(),origin:'Click',unitId:args[0],displayText:args[1],};}
var request=new ConverseTypes.UnitRequestObject();mergeExistingPropertiesInto(request,detail,request);return request;}
this.sendReportingEvent=function(variableName,variableValue){assertValidReportingEventArgs(arguments);var request=parseSendReportingEventData(arguments);return new Promise(function(resolve,reject){converse.sendReportingEvent(request,function(){_fireEvent(self.supportedEvents.SessionEventReported);resolve();},createHandleErrorPromiseResponse(reject));});};function assertValidReportingEventArgs(args){if(args.length<1||args.length>2){throw new Error('sendReportingEvent: expected 1 or 2 arguments, received '+args.length);}
if(args.length===1){if(typeof args[0]!=='object'||args[0]===null){throw new TypeError('sendReportingEvent: 1-arg version requires argument to be an object');}
if(!args[0].variableName){throw new Error('sendReportingEvent: 1-arg version must contain variableName property');}
if(!args[0].variableValue){throw new Error('sendReportingEvent: 1-arg version must contain variableValue property');}}else{if(typeof args[0]!=='string'||args[0]===null||args[0]===''){throw new TypeError('sendReportingEvent: 2-arg version requires first argument to be a string.');}
if(typeof args[1]!=='string'||args[1]===null||args[1]===''){throw new TypeError('sendReportingEvent: 2-arg version requires second argument to be a string.');}}}
function parseSendReportingEventData(args){var detail;if(args.length===1){detail=args[0];detail.userID=detail.userID||session.getAgentUserId();detail.sessionID=detail.sessionID||session.getAgentSessionId();}else{detail={userID:session.getAgentUserId(),sessionID:session.getAgentSessionId(),variableName:args[0],variableValue:args[1]};}
var request=new ConverseTypes.ReportingEventObject();mergeExistingPropertiesInto(request,detail,request);return request;}
this.revertConversation=function(messageRevision){assertValidRollbackArgs(arguments);var request=parseRevertConversationData(arguments);return new Promise(function(resolve,reject){converse.sendHistoryRollbackRequest(request,function(){_fireEvent(self.supportedEvents.ConversationReverted);resolve();},createHandleErrorPromiseResponse(reject));});};function assertValidRollbackArgs(args){if(args.length!==1){throw new Error('revertConversation: expected 1 argument, received '+args.length);}
var isArgValidInt=isValidMessageRevision(args[0]);if(!isArgValidInt){if(typeof args[0]!=='object'||args[0]===null){throw new TypeError('revertConversation: 1-arg version requires argument to be an object or a positive integer');}
if(!isValidMessageRevision(args[0].messageRevision)){throw new Error('revertConversation: advanced 1-arg version must contain positive integer value property');}}}
function parseRevertConversationData(args){var detail;if(isValidMessageRevision(args[0])){detail={userID:session.getAgentUserId(),sessionID:session.getAgentSessionId(),revision:args[0]};}else{detail={userID:args[0].userID||session.getAgentUserId(),sessionID:args[0].sessionID||session.getAgentSessionId(),revision:args[0].messageRevision};}
var request=new ConverseTypes.HistoryRollbackRequestObject();mergeExistingPropertiesInto(request,detail,request);return request;}
function isValidMessageRevision(value){return utils.isInt(value)&&value>0;}
function mergeExistingPropertiesInto(keySource,propertySource,propertyTarget){var prop;var unknownProperties=[];for(prop in propertySource){if(propertySource.hasOwnProperty(prop)){if(!keySource.hasOwnProperty(prop)){unknownProperties.push(prop);}}}
if(unknownProperties.length>0){throw new Error('Unknown properties: '+unknownProperties.join());}
for(prop in keySource){if(keySource.hasOwnProperty(prop)){if(typeof propertySource[prop]!=='undefined'){propertyTarget[prop]=propertySource[prop];}}}}
function handleResponse(response,resolve,reject){if(typeof response==="undefined"||response===null){return;}
updateUserIdIfNecessary(response);updateSessionIdIfNecessary(response);executeDeferredAppcall(response,resolve,reject);executeResponseActions(response);fireResponseReceivedEvent(response);resolvePromiseIfNecessary(response,resolve);}
function fireResponseReceivedEvent(response){_fireEvent(self.supportedEvents.ResponseReceived,response);}
function updateUserIdIfNecessary(response){if(response.userId&&utils.isNonEmptyGuid(response.userId)){session.setAgentUserId(response.userId);}}
function updateSessionIdIfNecessary(response){if(response.sessionId){session.setAgentSessionId(response.sessionId);}}
function resolvePromiseIfNecessary(response,resolve){if(resolve&&!response.deferredAppCall){resolve(response);}}
function handleError(xhr,statusText,error){_fireEvent(self.supportedEvents.ErrorReceived,xhr,statusText,error);}
function executeResponseActions(response){if(response.responseActions&&response.responseActions.length){for(var i=0;i<response.responseActions.length;i++){try{var parameters=response.responseActions[i];responseActionProvider.execute(parameters,response);}catch(e){logger.error("NIT.AGENT: Failure Processing '{0}' "+"response action handler - {1}".format(name,e.toString()));}}}}
function executeDeferredAppcall(response,resolve,reject){if(response.deferredAppCall){var name=response.deferredAppCall.AppcallName;var parameters=response.deferredAppCall.StructuredResponse;var event;try{var resultParameters=deferredAppcallProvider.execute(name,parameters,response);event=new ConverseTypes.ApplicationEventRequestObject(session.getAgentUserId(),session.getAgentSessionId(),"_sysResume","Deferred AppCall",resultParameters);}catch(e){logger.error("NIT.AGENT: Failure Processing '{0}' "+"deferred appcall handler - {1}".format(name,e.toString()));event=new ConverseTypes.ApplicationEventRequestObject(session.getAgentUserId(),session.getAgentSessionId(),"_sysResume","Deferred AppCall");}
converse.sendAppEvent(event,createHandlePromiseResponse(resolve),createHandleErrorPromiseResponse(reject));}}}
return{Agent:Agent};});define('NIT.Agent',['NIT.Agent.Types','NIT.Converse.Types','NIT.Converse','NIT.Session','NIT.ResponseActionProvider','NIT.DeferredAppcallProvider','NIT.Utils','NIT.Logger'],function(AgentTypes,ConverseTypes,converse,session,responseActionProvider,deferredAppCallProvider,utils,logger){'use strict';return new AgentTypes.Agent(ConverseTypes,converse,session,responseActionProvider,deferredAppCallProvider,utils,logger);});define('NIT.Communicator.Types',[],function(){function Communicator(settings,ajax){var DEFAULT_TIMEOUT=10000;var _timeout=DEFAULT_TIMEOUT;this.postJSON=function(url,input,onSuccessCallback,onFailureCallback){_ajaxCall(url,"POST",input,onSuccessCallback,onFailureCallback);return;};this.getJSON=function(url,input,onSuccessCallback,onFailureCallback){_ajaxCall(url,"GET",input,onSuccessCallback,onFailureCallback);return;};this.headerCheck=function(url,onSuccessCallback,onFailureCallback){_ajaxCall(url,"HEAD",null,onSuccessCallback,onFailureCallback);};function _ajaxCall(uri,methodType,input,onSuccess,onFailure){_updateTimeoutIfNeeded();var ajaxRequest={url:uri,method:methodType,withCredentials:true,crossOrigin:true,timeout:_timeout,success:function(data){if(onSuccess){onSuccess(data);}},error:function(xhr,statusText,error){if(onFailure){onFailure(xhr,statusText,error);}}};if(input!==null){ajaxRequest.contentType="application/json";ajaxRequest.type="json";ajaxRequest.data=JSON.stringify(input);}
ajax(ajaxRequest);}
function _updateTimeoutIfNeeded(){var timeoutSetting=settings.ClientTimeout;if(_timeout!==timeoutSetting&&!isNaN(timeoutSetting)){timeoutSetting=parseInt(timeoutSetting);if(timeoutSetting>=1){_timeout=timeoutSetting;}}}}
return{Communicator:Communicator};});define('NIT.Communicator',['NIT.Communicator.Types','NIT.Settings','reqwest'],function(CommunicatorTypes,settings,ajax){return new CommunicatorTypes.Communicator(settings,ajax);});define('NIT.Configurations.Types',[],function(){function ConfigurationRequest(channel)
{this.channel=channel||"Web";}
function Configurations(settings,communicator)
{this.getConfigurationSettings=function(request,successCallback,failureCallback){var uri=settings.BaseUrl+"api/Configuration/GetConfiguration";communicator.postJSON(uri,request,successCallback,failureCallback);};}
return{ConfigurationRequest:ConfigurationRequest,Configurations:Configurations};});define('NIT.Configurations',['NIT.Configurations.Types','NIT.Communicator','NIT.Settings'],function(ConfigurationsTypes,communicator,settings){return new ConfigurationsTypes.Configurations(settings,communicator);});define('NIT.Converse.Types',[],function(){'use strict';function ReportingEventObject(userID,sessionID,variableName,variableValue,channel){this.userID=userID;this.sessionID=sessionID;this.variableName=variableName;this.variableValue=variableValue;this.channel=channel||"Web";}
function ConverseRequestObject(userID,sessionID,text,inputDisplayText,origin,parameters,channel,language){this.userID=userID;this.sessionID=sessionID;this.question=text;this.displayText=inputDisplayText;this.origin=origin;this.parameters=parameters||{};this.channel=channel||"Web";this.language=language||"en-US";}
function UnitRequestObject(userID,sessionID,unitId,displayText,origin,parameters,channel,language){this.userID=userID;this.sessionID=sessionID;this.unitId=unitId;this.displayText=displayText;this.origin=origin;this.parameters=parameters||{};this.channel=channel||"Web";this.language=language||"en-US";}
function HistoryRollbackRequestObject(userID,sessionID,revision){this.userID=userID;this.sessionID=sessionID;this.revision=revision;}
function ApplicationEventRequestObject(userID,sessionID,eventName,origin,parameters,channel,language){this.userID=userID;this.sessionID=sessionID;this.eventName=eventName;this.origin=origin;this.parameters=parameters||{};this.channel=channel||"Web";this.language=language||"en-US";}
function GetHistoryRequestObject(userID,sessionID,messageLimit,includeRevertedEntries){this.userID=userID;this.sessionID=sessionID;this.messageLimit=messageLimit||0;this.includeRevertedEntries=includeRevertedEntries||false;}
function Converse(communicator,utils,logger,settings,responseActionProvider,deferredAppcallProvider){var _conversationApiUrl=settings.ConversationApiUrl||"/api/Conversation";var _conversationSupportApiUrl=settings.ConversationSupportApiUrl||"/api/ConversationSupport";function _sendTimeStampedRequest(request,apiEndpoint,onSuccess,onFailure){if(typeof request.parameters!=='undefined'){request.parameters.ClientTime=utils.getCurrentClientTime();}
_sendRequest(request,apiEndpoint,onSuccess,onFailure);}
function _sendRequest(request,apiEndpoint,onSuccess,onFailure){var requestUri=settings.BaseUrl+apiEndpoint;communicator.postJSON(requestUri,request,onSuccess,onFailure);}
return{sendHistoryRollbackRequest:function(historyRollbackObject,successCallback,failureCallback){var uri=_conversationApiUrl+"/RollBackHistory";_sendRequest(historyRollbackObject,uri,successCallback,failureCallback);},sendReportingEvent:function(reportingEventObject,successCallback,failureCallback){this.sendReportingEvents([reportingEventObject],successCallback,failureCallback);},sendReportingEvents:function(reportingEventObjects,successCallback,failureCallback){var uri=_conversationApiUrl+"/ReportingEvent";for(var i=0;i<reportingEventObjects.length;i++){_sendRequest(reportingEventObjects[i],uri,successCallback,failureCallback);}},sendAppEvent:function(appEventRequestObject,successCallback,failureCallback){var uri=_conversationApiUrl+"/appEvent";_sendTimeStampedRequest(appEventRequestObject,uri,successCallback,failureCallback);},sendUnitRequest:function(unitRequestObject,successCallback,failureCallback){var uri=_conversationApiUrl+"/RequestUnit";_sendTimeStampedRequest(unitRequestObject,uri,successCallback,failureCallback);},sendConverseRequest:function(converseRequestObject,successCallback,failureCallback){var uri=_conversationApiUrl+"/converse";_sendTimeStampedRequest(converseRequestObject,uri,successCallback,failureCallback);},sendGetHistoryRequest:function(getHistoryRequestObj,successCallback,failureCallback){var uri=_conversationSupportApiUrl+"/GetHistory";_sendRequest(getHistoryRequestObj,uri,successCallback,failureCallback);},handleDeferredAppCall:function(data,userID,sessionID,successCallback,failureCallback){var appcallToProcess=false;if(data.deferredAppCall){appcallToProcess=true;var name=data.deferredAppCall.AppcallName;var parameters=data.deferredAppCall.StructuredResponse;var event;try{var resultParameters=deferredAppcallProvider.execute(name,parameters,data);event=new ApplicationEventRequestObject(userID,sessionID,"_sysResume","Deferred AppCall",resultParameters);this.sendAppEvent(event,successCallback,failureCallback);}catch(e){event=new ApplicationEventRequestObject(userID,sessionID,"_sysResume","Deferred AppCall");this.sendAppEvent(event,successCallback,failureCallback);}}
return appcallToProcess;},handleResponseActions:function(data){var responseActionsToProcess=false;if(data.responseActions&&data.responseActions.length){responseActionsToProcess=true;for(var i=0;i<data.responseActions.length;i++){var parameters=data.responseActions[i];responseActionProvider.execute(parameters,data);}}
return responseActionsToProcess;}};}
return{ReportingEventObject:ReportingEventObject,ConverseRequestObject:ConverseRequestObject,UnitRequestObject:UnitRequestObject,HistoryRollbackRequestObject:HistoryRollbackRequestObject,ApplicationEventRequestObject:ApplicationEventRequestObject,GetHistoryRequestObject:GetHistoryRequestObject,Converse:Converse};});define('NIT.Converse',['NIT.Converse.Types','NIT.Communicator','NIT.Utils','NIT.Logger','NIT.Settings','NIT.ResponseActionProvider','NIT.DeferredAppcallProvider'],function(ConverseTypes,communicator,utils,logger,settings,responseActionProvider,deferredAppcallProvider){return new ConverseTypes.Converse(communicator,utils,logger,settings,responseActionProvider,deferredAppcallProvider);});define('NIT.DeferredAppcallProvider.Types',[],function(){function DeferredAppcallProvider(logger){var handlers={};this.registerHandler=function(daName,handler){if(typeof(handler)!=='function'){throw Error(handler+' is not a function');}
if(handlers[daName]){logger.warn('Handler for "{0}" deferred appcall is being overwritten'.format(daName));}
handlers[daName]=handler;return Object.keys(handlers).length;};this.unregisterHandler=function(daName){if(handlers[daName]){delete handlers[daName];}else{logger.warn('No handlers registered for "{0}" deferred appcall'.format(daName));}
return Object.keys(handlers).length;};this.execute=function(daName,params,data){var myHandler=handlers[daName];if(myHandler){try{return myHandler(params,data);}catch(e){logger.warn('Handler for "{0}" deferred appcall threw exception: {1}'.format(daName,e));}}else{logger.warn('No handlers registered for "{0}" deferred appcall'.format(daName));}
return null;};this.reset=function(){handlers={};};}
return{DeferredAppcallProvider:DeferredAppcallProvider};});define('NIT.DeferredAppcallProvider',['NIT.DeferredAppcallProvider.Types','NIT.Logger'],function(DeferredAppcallProviderTypes,logger){return new DeferredAppcallProviderTypes.DeferredAppcallProvider(logger);});(function(global){define('NIT.Logger.Types',[],function(){var levels={OFF:99,FATAL:5,ERROR:4,WARN:3,INFO:2,DEBUG:1,ALL:1};function Logger(console,settings){function shouldLog(targetLevel){var currentLevel=settings.UiLogLevel||levels.WARN;return(targetLevel>=currentLevel);}
function logImplFactory(level){return function(message){if(shouldLog(levels[level])){console.log(level+": "+message);}};}
this.fatal=logImplFactory("FATAL");this.error=logImplFactory("ERROR");this.warn=logImplFactory("WARN");this.info=logImplFactory("INFO");this.debug=logImplFactory("DEBUG");}
return{Logger:Logger,Levels:levels};});define('NIT.Logger',['NIT.Logger.Types','NIT.Console','NIT.Settings'],function(LoggerTypes,console,settings){return new LoggerTypes.Logger(console,settings);});define('NIT.Console',[],function(){return global.console||{log:function(){}};});})(typeof global!=='undefined'?global:typeof window!=='undefined'?window:this);define('NIT.ResponseActionProvider.Types',[],function(){function ResponseActionProvider(logger){var handlers={};this.registerHandler=function(raName,handler){if(typeof(handler)!=='function'){throw Error(handler+' is not a function');}
if(handlers[raName]){logger.warn('Handler for "{0}" response action is being overwritten'.format(raName));}
handlers[raName]=handler;return Object.keys(handlers).length;};this.unregisterHandler=function(raName){if(handlers[raName]){delete handlers[raName];}else{logger.warn('No handlers registered for "{0}" response action'.format(raName));}
return Object.keys(handlers).length;};this.execute=function(params,data){var raName=params.Name;var myHandler=handlers[raName];if(myHandler){try{myHandler(params,data);}catch(e){logger.warn('Handler for "{0}" response action threw exception: {1}'.format(raName,e));}}else{logger.warn('No handlers registered for "{0}" response action'.format(raName));}};this.reset=function(){handlers={};};}
return{ResponseActionProvider:ResponseActionProvider};});define('NIT.ResponseActionProvider',['NIT.ResponseActionProvider.Types','NIT.Logger'],function(ResponseActionProviderTypes,logger){return new ResponseActionProviderTypes.ResponseActionProvider(logger);});define('NIT.Session.Types',[],function(){function SessionService(utils,dataStore){var self=this;var _userID;var _sessionID;var USER_ID_KEY='User';var SESSION_ID_KEY='Session';this.getAgentUserId=function(){if(!_userID||_userID.length===0){_userID=dataStore.getData(USER_ID_KEY,null);if(!_userID||_userID.length===0){self.setAgentUserId(utils.createGuid());}}
return _userID;};this.setAgentUserId=function(userId){throwIfInvalidUserID(userId);_userID=userId;dataStore.storeData(USER_ID_KEY,_userID);};this.getAgentSessionId=function(){if(!_sessionID||_sessionID.length===0){_sessionID=dataStore.getData(SESSION_ID_KEY,null);if(!_sessionID||_sessionID.length===0){self.setAgentSessionId(utils.createGuid());}}
return _sessionID;};this.setAgentSessionId=function(sessionId){throwIfInvalidSessionID(sessionId);_sessionID=sessionId;dataStore.storeData(SESSION_ID_KEY,_sessionID);};function throwIfInvalidUserID(userID){if(!utils.isNonEmptyGuid(userID)){throw new Error('User ID must be a valid GUID');}}
function throwIfInvalidSessionID(sessionID){if(typeof sessionID!=="string"||sessionID.length>88){throw new Error('Session ID must be a string of 88 characters or less');}}}
return{SessionService:SessionService};});define('NIT.Session',['NIT.Session.Types','NIT.Utils','NIT.ClientDataStore'],function(SessionTypes,utils,dataStore){return new SessionTypes.SessionService(utils,dataStore);});define('NIT.Settings',['NIT.Logger.Types'],function(LoggerTypes){var settings={BaseUrl:calculateBaseUrl(),ClientTimeout:10000,ConversationApiUrl:'api/Conversation',ConversationSupportApiUrl:'api/ConversationSupport',UiLogLevel:LoggerTypes.Levels.WARN};function calculateBaseUrl(){var scriptSource='';var scriptTags=document.getElementsByTagName('script');for(var i=0;i<scriptTags.length;i++){var src=scriptTags[i].getAttribute('src',-1);if((/\/includes\/nit\.api\.min\.js$/i).test(src)||(/\/includes\/CoreAPI\/nit\.settings\.js$/i).test(src)){scriptSource=src;break;}}
return scriptSource.substr(0,scriptSource.toLowerCase().lastIndexOf('/includes/')+1);}
return settings;});define('NIT.SettingsLoader.Types',[],function(){function SettingsLoader(ConfigurationsTypes,settings,configurations,logger){var trueRegex=/^true$/i;var falseRegex=/^false$/i;function onSettingsLoaded(configurationResponse){for(var i=0;i<configurationResponse.configurationSettings.length;i++){parseConfigurationSetting(configurationResponse.configurationSettings[i]);}}
function parseConfigurationSetting(setting){var key=setting.Key;var value=setting.Value;var parsedValue;if(value&&value.beginsWith('<value')){parsedValue=parseValueXml(value);}else{if(value&&value.length>0&&!isNaN(value)){if(value.indexOf('.')>-1){parsedValue=parseFloat(value);}else{parsedValue=parseBase10Int(value);}}else if(isStringTrue(value)){parsedValue=true;}else if(isStringFalse(value)){parsedValue=false;}else{parsedValue=value;}}
settings[key]=parsedValue;logger.debug("{0}: {1}".format(key,parsedValue));}
function tryGetNamedItem(valueNode){try{return valueNode.attributes.getNamedItem('type');}catch(e){}}
function parseValueXml(value){var valueXmlDoc=value.parseXml();var valueNode=valueXmlDoc.firstChild;if(valueNode){var settingText=valueNode.textContent;if(typeof settingText==='undefined'){settingText=valueNode.text;}
var type=valueNode.attributes.type;if(typeof type==='undefined'){var typeAttr=tryGetNamedItem(valueNode);if(typeof typeAttr!=='undefined'&&typeAttr!==null){type=typeAttr;}}
switch((type?type.value:"").toLowerCase()){case'int':case'integer':case'number':return parseBase10Int(settingText);case'float':return parseFloat(settingText);case'json':case'object':return JSON.parse(settingText);case'bool':case'boolean':return isStringTrue(settingText);default:return settingText;}}else{return value;}}
function parseBase10Int(value){return parseInt(value,10);}
function isStringTrue(value){return trueRegex.test(value);}
function isStringFalse(value){return falseRegex.test(value);}
function onError(xhr,statusText,error){if(error){logger.fatal(statusText+' - '+error.name);}else{logger.fatal(statusText);}}
this.loadSettings=function(channel,successCallback,failureCallback){var request=new ConfigurationsTypes.ConfigurationRequest();request.channel=channel||"Web";configurations.getConfigurationSettings(request,function(successResponse){onSettingsLoaded(successResponse);if(typeof successCallback==='function'){successCallback(settings);}},function(xhr,statusText,error){onError(xhr,statusText,error);if(typeof failureCallback==='function'){failureCallback(xhr,statusText,error);}});};}
return{SettingsLoader:SettingsLoader};});define('NIT.SettingsLoader',['NIT.SettingsLoader.Types','NIT.Configurations.Types','NIT.Settings','NIT.Configurations','NIT.Logger'],function(SettingsLoaderTypes,ConfigurationsTypes,settings,configurations,logger){return new SettingsLoaderTypes.SettingsLoader(ConfigurationsTypes,settings,configurations,logger);});define('NIT.DateTimeProvider',[],function(){return{now:function(){return new Date();}};});define('NIT.Utils.Types',[],function(){function Utils(dateTimeProvider){this.escapeJSReservedCharacters=function(string){return String(string).replace(/\\/g,"\\\\").replace(/\'/g,"\\'").replace(/\"/g,"\\\"");};this.getCurrentClientTime=function(){var currentTime=dateTimeProvider.now();var hours=currentTime.getHours();var displayHours=(hours>12)?hours-12:(hours===0)?12:hours;var minutes=currentTime.getMinutes();var strTime;if(minutes<10){minutes="0"+minutes;}
strTime=displayHours.toString()+":"+minutes.toString()+" ";if(hours>11){strTime=strTime+"PM";}else{strTime=strTime+"AM";}
return strTime;};this.createGuid=function(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c==='x'?r:r&0x3|0x8;return v.toString(16);});};this.isNonEmptyGuid=function(value){if(typeof value==="undefined"||!value){return false;}
var guidRegex=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;return guidRegex.test(value);};this.isInt=function(value){return(typeof value==='number')&&(value%1===0);};}
return{Utils:Utils};});define('NIT.Utils',['NIT.Utils.Types','NIT.DateTimeProvider'],function(UtilsTypes,dateTimeProvider){return new UtilsTypes.Utils(dateTimeProvider);});define('NIT.CookieUtils.Types',[],function(){'use strict';function Cookie(name){var self=this;this.name=name;this.primaryValue=null;this.properties={};this.domain=null;this.path='/';this.isSecure=false;this.expiration=null;this.loadValues=function(strValues){var kvPairs=(typeof(strValues)==="string")?strValues.split('&'):null;if(kvPairs&&kvPairs.length>0&&strValues.indexOf('=')>-1){for(var i=0;i<kvPairs.length;i++){var valAssignIndex=kvPairs[i].indexOf('=');if(valAssignIndex>1){var key=kvPairs[i].substr(0,valAssignIndex);var value=kvPairs[i].substr(valAssignIndex+1);self.properties[key]=decodeURIComponent(value);}else if(i===0){self.primaryValue=decodeURIComponent(kvPairs[i]);}}}else{self.primaryValue=decodeURIComponent(strValues);}};this.serialize=function(){var v=encodeURIComponent(self.primaryValue||'');for(var propName in self.properties){if(self.properties.hasOwnProperty(propName)){var val=self.properties[propName]||'';v+='&{0}={1}'.format(encodeURIComponent(propName),encodeURIComponent(val));}}
if(v[0]==='&'){v=v.substr(1);}
return this.name+'='+v+
((self.expiration===null)?"":(";expires="+self.expiration.toUTCString()))+";path="+this.path+
((self.domain===null)?"":(";domain="+self.domain))+
((self.isSecure)?";secure;":";");};}
function CookieService(domainExtractor){var self=this;var epoch=new Date(1970,1,1);this.createNewCookie=function(name){var cookie=new Cookie(name);cookie.domain=domainExtractor.getBaseDomain();return cookie;};this.getOrCreateCookie=function(name){var existingCookie=self.getCookie(name);if(existingCookie){return existingCookie;}else{return self.createNewCookie(name);}};this.getCookie=function(name){return self.getCookies()[name]||null;};this.getCookies=function(){var all={};if(document.cookie!==""){var cookies=document.cookie.split("; ");for(var i=0;i<cookies.length;i++){var c=cookies[i];var idx=c.indexOf('=');var n;if(idx>0){n=c.substr(0,idx);}else{idx=c.length;n=c;}
var v;if(c.length>idx+1){v=c.substring(idx+1,c.length);}else{v='';}
var cookie=new Cookie(n);cookie.loadValues(v);cookie.domain=domainExtractor.getBaseDomain();all[n]=cookie;}}
return all;};this.saveCookie=function(cookie){if(typeof cookie!=="undefined"&&cookie!=null){serializeAndSaveCookie(cookie);}};this.deleteCookie=function(name){var cookies=self.getCookies();if(cookies.hasOwnProperty(name)){cookies[name].expiration=epoch;serializeAndSaveCookie(cookies[name]);}};this.getCookiesAsString=function(){var cookies=self.getCookies();var sCookie='';for(var crumb in cookies){if(cookies.hasOwnProperty(crumb)){sCookie+='Name: '+cookies[crumb].name+'\n';sCookie+='Value: '+cookies[crumb].primaryValue+'\n';for(var propName in cookies[crumb].properties){if(cookies[crumb].properties.hasOwnProperty(propName)){sCookie+="    "+propName+": ";sCookie+=cookies[crumb].properties[propName]+"\n";}}}}
return sCookie;};function serializeAndSaveCookie(cookie){document.cookie=cookie.serialize();}}
return{CookieService:CookieService,Cookie:Cookie};});define('NIT.CookieUtils',['NIT.CookieUtils.Types','NIT.DomainExtractor'],function(cookieUtilsTypes,domainExtractor){return new cookieUtilsTypes.CookieService(domainExtractor);});define('NIT.ClientDataStore.Types',[],function(){'use strict';function CookieDataStore(cookieUtils,logger){var SESSION_STATE_COOKIE='NIT_SessionState';this.getData=function(key,defVal){throwIfInvalidKey(key);logger.debug('Retrieving item "{0}"'.format(key));var sessionCookie=cookieUtils.getCookie(SESSION_STATE_COOKIE);if(sessionCookie&&sessionCookie.properties.hasOwnProperty(key)){return sessionCookie.properties[key];}
return defVal;};this.storeData=function(key,value){throwIfInvalidKey(key);logger.debug('Storing item "{0}": "{1}"'.format(key,value));var sessionCookie=cookieUtils.getOrCreateCookie(SESSION_STATE_COOKIE);sessionCookie.properties[key]=value;cookieUtils.saveCookie(sessionCookie);};this.removeData=function(key){throwIfInvalidKey(key);logger.debug('Removing item "{0}"'.format(key));var sessionCookie=cookieUtils.getCookie(SESSION_STATE_COOKIE);if(sessionCookie&&sessionCookie.properties.hasOwnProperty(key)){delete sessionCookie.properties[key];cookieUtils.saveCookie(sessionCookie);}};this.clear=function(){cookieUtils.deleteCookie(SESSION_STATE_COOKIE);};function throwIfInvalidKey(key){if(typeof key!=="string"||key.length<1){throw Error('Invalid Key Specified');}}}
return{CookieDataStore:CookieDataStore};});define('NIT.ClientDataStore',['NIT.ClientDataStore.Types','NIT.CookieUtils','NIT.Logger'],function(dataStoreTypes,cookieUtils,logger){return new dataStoreTypes.CookieDataStore(cookieUtils,logger);});define('NIT.DomainExtractor.Types',[],function(){'use strict';function DomainExtractorService(){var self=this;this.getCurrentDomain=function(){return document.domain;};this.getBaseDomain=function(){var domain=self.getCurrentDomain();var match=domain.match(/([A-Za-z0-9-]{1,63})+(\.[A-Za-z]{2,3}){1,2}$/i);if(match&&match.length>0){return match[0];}else{return domain;}};}
return{DomainExtractorService:DomainExtractorService};});define('NIT.DomainExtractor',['NIT.DomainExtractor.Types'],function(domainExtractorTypes){return new domainExtractorTypes.DomainExtractorService();});